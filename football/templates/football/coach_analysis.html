{% load static %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>{{ section_title }} · Cuerpo técnico</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      body {
        margin: 0;
        font-family: 'Inter', system-ui, sans-serif;
        background: linear-gradient(180deg, #020417 0%, #050b1c 100%);
        color: #f8fafc;
      }
      .page {
        max-width: 1100px;
        margin: 0 auto;
        padding: 2rem 1.25rem 3rem;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        margin-bottom: 1.5rem;
      }
      header h1 {
        margin: 0;
        text-transform: uppercase;
        letter-spacing: 0.15em;
      }
      header p {
        margin: 0;
        color: rgba(226, 232, 240, 0.7);
      }
      .panel {
        background: rgba(15, 23, 42, 0.95);
        border-radius: 24px;
        padding: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.55);
      }
      .grid {
        display: grid;
        gap: 1rem;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        margin-top: 1rem;
      }
      .item {
        padding: 1rem;
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background: rgba(15, 23, 42, 0.8);
        min-height: 110px;
      }
      .item h3 {
        margin: 0 0 0.4rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        font-size: 0.9rem;
      }
      .item p {
        margin: 0;
        color: rgba(226, 232, 240, 0.8);
      }
      .button {
        border-radius: 999px;
        padding: 0.7rem 1.4rem;
        border: none;
        background: linear-gradient(135deg, #facc15, #f97316);
        font-weight: 700;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        cursor: pointer;
      }
      .ghost {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.18);
        color: #f8fafc;
      }
      .form {
        margin-top: 1.5rem;
        display: grid;
        gap: 0.8rem;
      }
      label {
        font-size: 0.85rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: rgba(226, 232, 240, 0.7);
      }
      input,
      select,
      textarea {
        width: 100%;
        padding: 0.8rem 0.9rem;
        border-radius: 12px;
        border: 1px solid rgba(148, 163, 184, 0.3);
        background: rgba(2, 6, 23, 0.55);
        color: #e2e8f0;
        font-size: 0.95rem;
        appearance: none;
      }
      textarea {
        min-height: 180px;
        resize: vertical;
      }
      .actions {
        display: flex;
        gap: 0.8rem;
        justify-content: flex-end;
        margin-top: 0.5rem;
      }
      .error {
        color: #fca5a5;
        margin-top: 0.5rem;
      }
      .list {
        margin: 0;
        padding: 0;
        list-style: none;
      }
      .list li {
        padding: 0.35rem 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      }
      .meta {
        color: rgba(226, 232, 240, 0.7);
        font-size: 0.85rem;
      }
    </style>
  </head>
  <body>
    <div class="page">
      <header>
        <div>
          <p>Área técnica · Cuerpo técnico</p>
          <h1>{{ section_title }}</h1>
        </div>
        <a class="button ghost" href="{% url 'coach-detail' %}">Volver</a>
      </header>
      <article class="panel">
        <p>{{ description }}</p>
        <form class="form" method="post">
          {% csrf_token %}
          <div>
            <label for="team_id">Equipo rival</label>
            <select id="team_id" name="team_id">
              <option value="">Selecciona un equipo</option>
              {% for team in teams %}
              <option value="{{ team.id }}" {% if team_id|stringformat:"s" == team.id|stringformat:"s" %}selected{% endif %}>
                {{ team.name }}
              </option>
              {% endfor %}
            </select>
          </div>
          <div>
            <label for="team_url">URL del rival (opcional)</label>
            <input id="team_url" name="team_url" type="text" value="{{ team_url }}" />
          </div>
          <div>
            <label for="raw_text">Pega aquí el texto/HTML de LaPreferente</label>
            <textarea id="raw_text" name="raw_text">{{ raw_text }}</textarea>
          </div>
          <div class="actions">
            <button class="button" type="submit">Analizar rival</button>
          </div>
          {% if error %}
          <p class="error">{{ error }}</p>
          {% endif %}
        </form>
        {% if roster %}
        <div class="grid">
          <div class="item">
            <h3>11 probable</h3>
            <ul class="list">
              {% for player in probable_eleven %}
              <li>
                <strong>{{ player.name }}</strong>
                <span class="meta">· {{ player.position }} · {{ player.minutes }} min</span>
              </li>
              {% endfor %}
            </ul>
          </div>
          <div class="item">
            <h3>Máximos goleadores</h3>
            <ul class="list">
              {% for player in insights.top_scorers %}
              <li>
                <strong>{{ player.name }}</strong>
                <span class="meta">· {{ player.goals }} goles · {{ player.minutes }} min</span>
              </li>
              {% endfor %}
            </ul>
          </div>
          <div class="item">
            <h3>Más minutos</h3>
            <ul class="list">
              {% for player in insights.most_minutes %}
              <li>
                <strong>{{ player.name }}</strong>
                <span class="meta">· {{ player.minutes }} min · {{ player.position }}</span>
              </li>
              {% endfor %}
            </ul>
          </div>
          <div class="item">
            <h3>Más tarjetas</h3>
            <ul class="list">
              {% for player in insights.most_cards %}
              <li>
                <strong>{{ player.name }}</strong>
                <span class="meta">· {{ player.yellow_cards }}A · {{ player.red_cards }}R</span>
              </li>
              {% endfor %}
            </ul>
          </div>
        </div>
        {% endif %}
      </article>
    </div>
  </body>
</html>
